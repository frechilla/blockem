<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">

<html lang="en">

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
  <title>LCOV - Blockem Tests Code Coverage - /home/frechilla/workspace/headless/blockem_sourceforge/src/bitwise.h</title>
  <link rel="stylesheet" type="text/css" href="../../../../../../gcov.css">
</head>

<body>

  <table width="100%" border=0 cellspacing=0 cellpadding=0>
    <tr><td class="title">LCOV - code coverage report</td></tr>
    <tr><td class="ruler"><img src="../../../../../../glass.png" width=3 height=3 alt=""></td></tr>

    <tr>
      <td width="100%">
        <table cellpadding=1 border=0 width="100%">
        <tr>
          <td width="5%"></td>
          <td width="10%" class="headerItem">Current view:</td>
          <td width="35%" class="headerValue"><a href="../../../../../../index.html">directory</a> - <a href="index.html">home/frechilla/workspace/headless/blockem_sourceforge/src</a> - bitwise.h (source / <a href="bitwise.h.func.html">functions</a>)</td>
          <td width="10%"></td>
          <td width="10%" class="headerCovTableHead">Found</td>
          <td width="10%" class="headerCovTableHead">Hit</td>
          <td width="15%" class="headerCovTableHead">Coverage</td>
          <td width="5%"></td>
        </tr>
        <tr>
          <td></td>
          <td class="headerItem">Test:</td>
          <td class="headerValue">Blockem Tests Code Coverage</td>
          <td class="headerItem">Lines:</td>
          <td class="headerCovTableEntry">6</td>
          <td class="headerCovTableEntry">6</td>
          <td class="headerCovTableEntryHi">100.0 %</td>
        </tr>
        <tr>
          <td></td>
          <td class="headerItem">Date:</td>
          <td class="headerValue">2010-06-03</td>
          <td class="headerItem">Functions:</td>
          <td class="headerCovTableEntry">1</td>
          <td class="headerCovTableEntry">0</td>
          <td class="headerCovTableEntryLo">0.0 %</td>
        </tr>
                <tr><td><img src="../../../../../../glass.png" width=3 height=3 alt=""></td></tr>
        </table>
      </td>
    </tr>
    <tr><td class="ruler"><img src="../../../../../../glass.png" width=3 height=3 alt=""></td></tr>
  </table>

  <table cellpadding=0 cellspacing=0 border=0>
    <tr>
      <td><br></td>
    </tr>
    <tr>
      <td><pre class="source">
<a name="1"><span class="lineNum">       1 </span>                : // ============================================================================</a>
<span class="lineNum">       2 </span>                : // Copyright 2010 Faustino Frechilla
<span class="lineNum">       3 </span>                : //
<span class="lineNum">       4 </span>                : // This file is part of Blockem.
<span class="lineNum">       5 </span>                : //
<span class="lineNum">       6 </span>                : // Blockem is free software: you can redistribute it and/or modify it under the
<span class="lineNum">       7 </span>                : // terms of the GNU General Public License as published by the Free Software
<span class="lineNum">       8 </span>                : // Foundation, either version 3 of the License, or (at your option) any later
<span class="lineNum">       9 </span>                : // version.
<span class="lineNum">      10 </span>                : //
<span class="lineNum">      11 </span>                : // Blockem is distributed in the hope that it will be useful, but WITHOUT ANY
<span class="lineNum">      12 </span>                : // WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS
<span class="lineNum">      13 </span>                : // FOR A PARTICULAR PURPOSE. See the GNU General Public License for more
<span class="lineNum">      14 </span>                : // details.
<span class="lineNum">      15 </span>                : //
<span class="lineNum">      16 </span>                : // You should have received a copy of the GNU General Public License along
<span class="lineNum">      17 </span>                : // with Blockem. If not, see http://www.gnu.org/licenses/.
<span class="lineNum">      18 </span>                : //
<span class="lineNum">      19 </span>                : /// @file  bitwise.h
<span class="lineNum">      20 </span>                : /// @brief Contains operations to handle bitwise representations of board and pieces
<span class="lineNum">      21 </span>                : ///
<span class="lineNum">      22 </span>                : /// @author Faustino Frechilla
<span class="lineNum">      23 </span>                : /// @history
<span class="lineNum">      24 </span>                : /// Ref       Who                When         What
<span class="lineNum">      25 </span>                : ///           Faustino Frechilla 6-May-2010  Original development
<span class="lineNum">      26 </span>                : /// @endhistory
<span class="lineNum">      27 </span>                : ///
<span class="lineNum">      28 </span>                : // ============================================================================
<span class="lineNum">      29 </span>                : 
<span class="lineNum">      30 </span>                : #ifndef _BITWISE_H_
<span class="lineNum">      31 </span>                : #define _BITWISE_H_
<span class="lineNum">      32 </span>                : 
<span class="lineNum">      33 </span>                : #include &lt;stdint.h&gt; // for types
<span class="lineNum">      34 </span>                : #include &quot;board.h&quot;
<span class="lineNum">      35 </span>                : #include &quot;player.h&quot;
<span class="lineNum">      36 </span>                : #include &quot;piece.h&quot;
<span class="lineNum">      37 </span>                : 
<span class="lineNum">      38 </span>                : /// this namespace contains several methods to create, check and handle
<span class="lineNum">      39 </span>                : /// bitwise representations of the board and pieces. The final aim is to improve
<span class="lineNum">      40 </span>                : /// performance of traversing the search tree
<span class="lineNum">      41 </span>                : namespace bitwise
<span class="lineNum">      42 </span>                : {
<span class="lineNum">      43 </span>                :     /// Calculate a 7x7 bitwise representation of 'a_board' with center
<span class="lineNum">      44 </span>                :     /// wherever the parameter 'a_coord' says. It has 1 where the board is occupied
<span class="lineNum">      45 </span>                :     /// and 0 wherever it is empty
<span class="lineNum">      46 </span>                :     /// This 7x7 representation can be used with the rest of bitwise representations
<span class="lineNum">      47 </span>                :     /// of pieces (have a look at namespace bitwise)
<span class="lineNum">      48 </span>                :     /// Basically it takes a picture of the current state of a 7x7 square
<span class="lineNum">      49 </span>                :     /// sourrounding 'a_coord' and saves it in an uint64_t (which is saved in out_bitwiseBoard)
<span class="lineNum">      50 </span>                :     ///
<span class="lineNum">      51 </span>                :     /// The hypothetical bitwise representation of the whole board would be surrounded by
<span class="lineNum">      52 </span>                :     /// 3 rows and 3 cols always set to 1 (non available) in order to easily (and quickly)
<span class="lineNum">      53 </span>                :     /// check whether a piece is inside or outside the board. For example, if the board is 14x14
<span class="lineNum">      54 </span>                :     /// a 7x7 bitwise representation of the coordinate 0,0 is (note that the coordinate 0,0 is
<span class="lineNum">      55 </span>                :     /// written by an 'x'. 1 means taken and 0 empty)
<span class="lineNum">      56 </span>                :     /// 1 1 1 1 1 1 1
<span class="lineNum">      57 </span>                :     /// 1 1 1 1 1 1 1
<span class="lineNum">      58 </span>                :     /// 1 1 1 1 1 1 1
<span class="lineNum">      59 </span>                :     /// 1 1 1 x 0 0 0
<span class="lineNum">      60 </span>                :     /// 1 1 1 0 0 0 0
<span class="lineNum">      61 </span>                :     /// 1 1 1 0 0 0 0
<span class="lineNum">      62 </span>                :     /// 1 1 1 0 0 0 0
<span class="lineNum">      63 </span>                :     ///
<span class="lineNum">      64 </span>                :     /// which would be: 1111111 1111111 1111111 111x000 1110000 1110000 1110000 = fffffffffe1c3870 (if x is 0)
<span class="lineNum">      65 </span>                :     ///
<span class="lineNum">      66 </span>                :     /// In the case of out_bitwisePlayerBoard it only has 1s where 'a_player' has pieces deployed
<span class="lineNum">      67 </span>                :     /// on the board. Any other bit will be set to 0, except for the bits which are not used at the
<span class="lineNum">      68 </span>                :     /// beginning of the uint64_t, which are always set to 1
<span class="lineNum">      69 </span>                :     /// @param a const reference to the board which will be used to calculate bitwise representations
<span class="lineNum">      70 </span>                :     /// @param coordinate to be used as center of the 7x7 square
<span class="lineNum">      71 </span>                :     /// @param player whose pieces will be represented in out_bitwisePlayerBoard
<span class="lineNum">      72 </span>                :     /// @param 7x7 representation of the whole board (1 means coord is not empty, 0 it is empty)
<span class="lineNum">      73 </span>                :     /// @param 7x7 representation of the pieces of 'a_play
<span class="lineNum">      74 </span>                :     void BoardCalculate(
<span class="lineNum">      75 </span>                :             const Board      &amp;a_board,
<span class="lineNum">      76 </span>                :             const Coordinate &amp;a_coord,
<span class="lineNum">      77 </span>                :             const Player     &amp;a_player,
<span class="lineNum">      78 </span>                :             uint64_t         &amp;out_bitwiseBoard,
<span class="lineNum">      79 </span>                :             uint64_t         &amp;out_bitwisePlayerBoard);
<span class="lineNum">      80 </span>                : 
<span class="lineNum">      81 </span>                :     /// Move right (row = old_row. column = old_column + 1) the 7x7 bitwise representations of the board saved
<span class="lineNum">      82 </span>                :     /// in in_out_bitwiseBoard and the bitwise representation of 'a_player' pieces in in_out_bitwisePlayerBoard
<span class="lineNum">      83 </span>                :     /// @param const reference to the board which will be used to calculate bitwise representations
<span class="lineNum">      84 </span>                :     /// @param const reference to the the old coordinate, i.e. before moving to the right
<span class="lineNum">      85 </span>                :     /// @param const reference to the player whose bitwise representation will be calculated in in_out_bitwisePlayerBoard
<span class="lineNum">      86 </span>                :     /// @param current bitwise representation of the board. It will be overwritten with the representation
<span class="lineNum">      87 </span>                :     ///        of the board moved 1 position to the right
<span class="lineNum">      88 </span>                :     /// @param current bitwise representation of a_player's pieces on the board. It will be overwritten with
<span class="lineNum">      89 </span>                :     ///        the representation of a_player's pieces moved 1 position to the right
<span class="lineNum">      90 </span>                :     void BoardMoveRight(
<span class="lineNum">      91 </span>                :             const Board      &amp;a_board,
<span class="lineNum">      92 </span>                :             const Coordinate &amp;a_coord,
<span class="lineNum">      93 </span>                :             const Player     &amp;a_player,
<span class="lineNum">      94 </span>                :             uint64_t         &amp;in_out_bitwiseBoard,
<span class="lineNum">      95 </span>                :             uint64_t         &amp;in_out_bitwisePlayerBoard);
<span class="lineNum">      96 </span>                : 
<span class="lineNum">      97 </span>                :     /// Move left (row = old_row. column = old_column - 1) the 7x7 bitwise representations of the board saved
<span class="lineNum">      98 </span>                :     /// in in_out_bitwiseBoard and the bitwise representation of 'a_player' pieces in in_out_bitwisePlayerBoard
<span class="lineNum">      99 </span>                :     /// @param const reference to the board which will be used to calculate bitwise representations
<span class="lineNum">     100 </span>                :     /// @param const reference to the the old coordinate, i.e. before moving to the left
<span class="lineNum">     101 </span>                :     /// @param const reference to the player whose bitwise representation will be calculated in in_out_bitwisePlayerBoard
<span class="lineNum">     102 </span>                :     /// @param current bitwise representation of the board. It will be overwritten with the representation
<span class="lineNum">     103 </span>                :     ///        of the board moved 1 position to the left
<span class="lineNum">     104 </span>                :     /// @param current bitwise representation of a_player's pieces on the board. It will be overwritten with
<span class="lineNum">     105 </span>                :     ///        the representation of a_player's pieces moved 1 position to the left
<span class="lineNum">     106 </span>                :     void BoardMoveLeft(
<span class="lineNum">     107 </span>                :             const Board      &amp;a_board,
<span class="lineNum">     108 </span>                :             const Coordinate &amp;a_coord,
<span class="lineNum">     109 </span>                :             const Player     &amp;a_player,
<span class="lineNum">     110 </span>                :             uint64_t         &amp;in_out_bitwiseBoard,
<span class="lineNum">     111 </span>                :             uint64_t         &amp;in_out_bitwisePlayerBoard);
<span class="lineNum">     112 </span>                : 
<span class="lineNum">     113 </span>                :     /// Move down (row = old_row + 1. column = old_column) the 7x7 bitwise representations of the board
<span class="lineNum">     114 </span>                :     /// saved in in_out_bitwiseBoard and the bitwise representation of 'a_player' pieces
<span class="lineNum">     115 </span>                :     /// in in_out_bitwisePlayerBoard
<span class="lineNum">     116 </span>                :     /// @param const reference to the board which will be used to calculate bitwise representations
<span class="lineNum">     117 </span>                :     /// @param const reference to the the old coordinate, i.e. before moving downwards
<span class="lineNum">     118 </span>                :     /// @param const reference to the player whose bitwise representation will be calculated in in_out_bitwisePlayerBoard
<span class="lineNum">     119 </span>                :     /// @param current bitwise representation of the board. It will be overwritten with the representation
<span class="lineNum">     120 </span>                :     ///        of the board moved 1 position downwards
<span class="lineNum">     121 </span>                :     /// @param current bitwise representation of a_player's pieces on the board. It will be overwritten with
<span class="lineNum">     122 </span>                :     ///        the representation of a_player's pieces moved 1 position downwards
<span class="lineNum">     123 </span>                :     void BoardMoveDown(
<span class="lineNum">     124 </span>                :             const Board      &amp;a_board,
<span class="lineNum">     125 </span>                :             const Coordinate &amp;a_coord,
<span class="lineNum">     126 </span>                :             const Player     &amp;a_player,
<span class="lineNum">     127 </span>                :             uint64_t         &amp;in_out_bitwiseBoard,
<span class="lineNum">     128 </span>                :             uint64_t         &amp;in_out_bitwisePlayerBoard);
<span class="lineNum">     129 </span>                : 
<span class="lineNum">     130 </span>                :     /// @brief checks if a_bPiece can be put down in the board
<span class="lineNum">     131 </span>                :     /// have a look at bitwise:BoardCalculate if you want to know more about bitwise operations
<span class="lineNum">     132 </span>                :     /// @param bitwise representation of the piece
<span class="lineNum">     133 </span>                :     /// @param bitwise representation of the whole board
<a name="134"><span class="lineNum">     134 </span>                :     /// @param bitwise representation of the a_bPiece's owner's (player) pieces on the board</a>
<span class="lineNum">     135 </span>                :     /// @return true if a_bPiece can be put down on the board
<span class="lineNum">     136 </span><span class="lineCov">          84084 :     inline bool IsPieceDeployable(uint64_t a_bPiece, uint64_t a_bitwiseBoard, uint64_t a_bitwisePlayerBoard)</span>
<span class="lineNum">     137 </span>                :     {
<span class="lineNum">     138 </span>                :         // does the piece fit in the board?
<span class="lineNum">     139 </span><span class="lineCov">          84084 :         if ( (a_bPiece ^ (a_bPiece &amp; a_bitwiseBoard)) == a_bPiece )</span>
<span class="lineNum">     140 </span>                :         {
<span class="lineNum">     141 </span>                :             // there's space for this piece in the board. Check if this
<span class="lineNum">     142 </span>                :             // place is valid
<span class="lineNum">     143 </span>                : 
<span class="lineNum">     144 </span>                :             // does the piece touch the side of another a_player's piece?
<span class="lineNum">     145 </span><span class="lineCov">          52364 :             if ( (((a_bPiece &lt;&lt; 7) ^ ((a_bPiece &lt;&lt; 7) &amp; a_bitwisePlayerBoard)) == (a_bPiece &lt;&lt; 7)) &amp;&amp; // move up</span>
<span class="lineNum">     146 </span>                :                  (((a_bPiece &gt;&gt; 7) ^ ((a_bPiece &gt;&gt; 7) &amp; a_bitwisePlayerBoard)) == (a_bPiece &gt;&gt; 7)) &amp;&amp; // move down
<span class="lineNum">     147 </span>                :                  (((a_bPiece &lt;&lt; 1) ^ ((a_bPiece &lt;&lt; 1) &amp; a_bitwisePlayerBoard)) == (a_bPiece &lt;&lt; 1)) &amp;&amp; // move left
<span class="lineNum">     148 </span>                :                  (((a_bPiece &gt;&gt; 1) ^ ((a_bPiece &gt;&gt; 1) &amp; a_bitwisePlayerBoard)) == (a_bPiece &gt;&gt; 1)) )  // move right
<span class="lineNum">     149 </span>                :             {
<span class="lineNum">     150 </span>                :                 // does it touch a corner (a.k.a. nk point)?
<span class="lineNum">     151 </span><span class="lineCov">          47249 :                 if ( (((a_bPiece &lt;&lt; 8) ^ ((a_bPiece &lt;&lt; 8) &amp; a_bitwisePlayerBoard)) != (a_bPiece &lt;&lt; 8)) || // up-left corner</span>
<span class="lineNum">     152 </span>                :                      (((a_bPiece &lt;&lt; 6) ^ ((a_bPiece &lt;&lt; 6) &amp; a_bitwisePlayerBoard)) != (a_bPiece &lt;&lt; 6)) || // up-right corner
<span class="lineNum">     153 </span>                :                      (((a_bPiece &gt;&gt; 8) ^ ((a_bPiece &gt;&gt; 8) &amp; a_bitwisePlayerBoard)) != (a_bPiece &gt;&gt; 8)) || // down-left corner
<span class="lineNum">     154 </span>                :                      (((a_bPiece &gt;&gt; 6) ^ ((a_bPiece &gt;&gt; 6) &amp; a_bitwisePlayerBoard)) != (a_bPiece &gt;&gt; 6)) )  // down-right corner
<span class="lineNum">     155 </span>                :                 {
<span class="lineNum">     156 </span><span class="lineCov">           2815 :                     return true;</span>
<span class="lineNum">     157 </span>                :                 }
<span class="lineNum">     158 </span>                :             }
<span class="lineNum">     159 </span>                :         }
<span class="lineNum">     160 </span>                : 
<span class="lineNum">     161 </span><span class="lineCov">          81269 :         return false;</span>
<span class="lineNum">     162 </span>                :     }
<span class="lineNum">     163 </span>                : }
<span class="lineNum">     164 </span>                : 
<span class="lineNum">     165 </span>                : #endif // _BITWISE_H_
</pre>
      </td>
    </tr>
  </table>
  <br>

  <table width="100%" border=0 cellspacing=0 cellpadding=0>
  <tr><td class="ruler"><img src="../../../../../../glass.png" width=3 height=3 alt=""></td></tr>
  <tr><td class="versionInfo">Generated by: <a href="http://ltp.sourceforge.net/coverage/lcov.php" target="_parent">LCOV version 1.7</a></td></tr>
  </table>
  <br>

</body>
</html>
